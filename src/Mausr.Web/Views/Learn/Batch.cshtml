@model LearnBatchViewModel

@{
	ViewBag.Title = "Learning";
	int imageSize = 256;
}

@if (Model.SavedDrawing != null) {
	<div class="alert alert-success">
		<a href="#" class="close" data-dismiss="alert">&times;</a>
		<strong>Success!</strong> Drawing of '@Model.SavedDrawing.Symbol.SymbolStr' was successfully saved under ID @Model.SavedDrawing.SymbolDrawingId.
	</div>
}

<h1>Learning: @Model.Symbol.SymbolStr <small>@Model.Symbol.Name</small></h1>

@using (Html.BeginForm()) {
	@Html.AntiForgeryToken()

	<div class="form-horizontal">
		@Html.ValidationSummary(true, "", new { @class = "text-danger" })
		<div class="form-group col-md-12">
			<canvas id="canvas" class="img-thumbnail" width="@imageSize" height="@imageSize"></canvas>
		</div>

		<div class="form-group">
			<div class="col-md-2">
				<input type="submit" value="Save" class="btn btn-primary btn-lg btn-block" />
			</div>
			<div class="col-md-2">
				<a class="btn btn-default btn-lg btn-block" id="clearBtn" href="#" role="button">Clear</a>
			</div>
			<div class="col-md-2">
				@(Html.ActionLink("Skip", MVC.Learn.Batch().AddRouteValues(new BatchInitViewModel() {
					DrawingDevice = Model.DrawingDevice,
					DrawingTool = Model.DrawingTool,
					BatchNumber = Model.BatchNumber,
					SymbolNumber = Model.SymbolNumber + 1,
				}), new { @class = "btn btn-default btn-lg btn-block", role = "button" }))
			</div>
		</div>

		<div class="form-group">
			@Html.TextAreaFor(m => m.JsonData, 10, 40, new { @class = "form-control" })
			@Html.ValidationMessageFor(model => model.JsonData, "", new { @class = "text-danger" })
		</div>
	</div>
}

<p>Symbol: @(Model.SymbolNumber + 1) / @Model.SymbolsCount, Batch ID: @Model.BatchNumber</p>

@section scripts {
	<script src="~/Scripts/Mausr.js"></script>
	<script src="~/Scripts/Mausr.painter.js"></script>

	<script>
		$(function () {
			new MausrPainter({
				canvasId: 'canvas',
				jsonTextId: '@Html.NameFor(m => m.JsonData)',
				clearBtnId: 'clearBtn'
			});
		});
	</script>
}


